 ;LowNullAssemblyShellcode.src
 ;Elias Augusto 3/31/2019
 ;The shellcode in Example_Shellcode.cpp
 ;Assemble with the Renesas Assembler
 ;Learn more in this article:
 
 .SECTION CD, CODE, ALIGN=4
  _START:
  MOV.L #H'57111111,r3 ;Padded version of our "W" character is moved to r3
  SHLR8 r3 ;Using bitshifts
  SHLR16 r3 ;Converted to H'00000057
  MOV.L r3, @(H'2C,r15) ;Unpadded version sent to the stack
  XOR r0,r0
  ADD r15,r0
  ADD #H'2C,r0 ;Stack address sent to r0
  MOV.L r0,@(H'4,r15) ;Send the address to the stack in a different location
  MOV.L #H'01FB87D8,r0 ;Offset of MessageBoxW
  XOR r7,r7 ;MB_OK
  MOV.L @(H'4,r15),r5 ;MB Title
  MOV.L @(H'4,r15),r6 ;MB Caption
  XOR r4,r4 ;Set MB Owner to NULL
  JMP @r0 ;jump to the offset
  .END
